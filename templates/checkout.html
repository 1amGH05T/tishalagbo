{% extends 'base.html' %}

{% block title %}Checkout - Tishaalgbo{% endblock %}

{% block content %}
<div class="bg-gray-50 py-12 md:py-20">
    <div class="container mx-auto px-6">
        <h1 class="font-heading text-4xl font-bold text-brand-dark mb-8 text-center">Secure Checkout</h1>

        <div class="flex flex-col lg:flex-row gap-8 max-w-6xl mx-auto">

            <!-- Order Summary -->
            <div class="lg:w-1/2 order-2 lg:order-1">
                <div class="bg-white rounded-2xl shadow-sm border border-gray-100 p-6 md:p-8">
                    <h3 class="font-heading text-xl font-bold text-gray-800 mb-6 pb-4 border-b border-gray-100">Order
                        Summary</h3>

                    {% if cart_items %}
                    <div class="space-y-4 mb-6">
                        {% for item in cart_items %}
                        <div class="flex items-center gap-4">
                            {% if item.image %}
                            <div class="w-16 h-16 bg-gray-100 rounded-lg overflow-hidden flex-shrink-0">
                                <img src="{{ item.image }}" alt="{{ item.title }}" class="w-full h-full object-cover">
                            </div>
                            {% else %}
                            <div
                                class="w-16 h-16 bg-gray-100 rounded-lg flex items-center justify-center text-xs text-gray-400">
                                No img
                            </div>
                            {% endif %}

                            <div class="flex-grow">
                                <h4 class="font-bold text-gray-800 text-sm">{{ item.title }}</h4>
                                <p class="text-gray-500 text-xs">Qty: {{ item.quantity }}</p>
                            </div>
                            <div class="text-right">
                                <span class="font-bold text-brand-dark">Item Total: &#8358;{{ item.total }}</span>
                            </div>
                        </div>
                        {% endfor %}
                    </div>

                    <div class="border-t border-gray-100 pt-4 flex justify-between items-center">
                        <span class="text-lg font-bold text-brand-dark">Grand Total</span>
                        <span class="text-2xl font-bold text-brand">&#8358;{{ total_price }}</span>
                    </div>
                    {% else %}
                    <p class="text-gray-500 text-center py-8">Your cart is empty.</p>
                    <div class="text-center">
                        <a href="{% url 'products' %}" class="text-brand hover:underline font-medium">Continue
                            Shopping</a>
                    </div>
                    {% endif %}
                </div>
            </div>

            <!-- Checkout Form -->
            <div class="lg:w-1/2 order-1 lg:order-2">
                <div class="bg-white rounded-2xl shadow-lg border border-gray-100 p-6 md:p-8 relative overflow-hidden">
                    <div class="absolute top-0 right-0 p-4 opacity-10">
                        <svg class="w-32 h-32 text-brand" fill="currentColor" viewBox="0 0 24 24">
                            <path
                                d="M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2zm1 15h-2v-6h2v6zm0-8h-2V7h2v2z" />
                        </svg>
                    </div>

                    <h3
                        class="font-heading text-xl font-bold text-gray-800 mb-6 pb-4 border-b border-gray-100 relative z-10">
                        Shipping Details</h3>

                    {% if cart_items %}
                    <form action="https://formsubmit.co/your@email.com" method="POST" class="space-y-6 relative z-10">

                        <!-- FormSubmit Configuration -->
                        <input type="hidden" name="_subject" value="New Order from Tishaalgbo">
                        <input type="hidden" name="_next"
                            value="{{ request.scheme }}://{{ request.get_host }}{% url 'products' %}">
                        <input type="hidden" name="_captcha" value="false">
                        <input type="hidden" name="order_summary" value="{{ order_summary }}">

                        <div>
                            <label class="block text-sm font-medium text-gray-700 mb-2">Full Name</label>
                            <input type="text" name="name" class="input-field" placeholder="John Doe" required>
                        </div>

                        <div>
                            <label class="block text-sm font-medium text-gray-700 mb-2">Email Address</label>
                            <input type="email" name="email" class="input-field" placeholder="john@example.com"
                                required>
                        </div>

                        <div>
                            <label class="block text-sm font-medium text-gray-700 mb-2">Delivery Address</label>
                            <textarea name="address" rows="4" class="input-field"
                                placeholder="Enter your full delivery address..." required></textarea>
                        </div>

                        <div class="pt-4">
                            <button type="submit"
                                class="w-full btn-primary py-4 text-lg shadow-brand-dark/20 shadow-lg">
                                Complete Order
                            </button>
                            <p class="text-center text-xs text-gray-400 mt-4 flex items-center justify-center gap-1">
                                <svg class="w-3 h-3" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                                        d="M12 15v2m-6 4h12a2 2 0 002-2v-6a2 2 0 00-2-2H6a2 2 0 00-2 2v6a2 2 0 002 2zm10-10V7a4 4 0 00-8 0v4h8z">
                                    </path>
                                </svg>
                                Secure Transaction
                            </p>
                        </div>
                    </form>
                    {% else %}
                    <div class="text-center py-8 relative z-10">
                        <p class="text-gray-500 mb-4">You need items in your cart to checkout.</p>
                        <a href="{% url 'products' %}" class="btn-primary inline-block">Browse Products</a>
                    </div>
                    {% endif %}
                </div>
            </div>
        </div>
    </div>
</div>
{% endblock %}